<style>
    .workspace {
        border-color: #454456 !important;
        border: 1px solid transparent;
        background-color: #fbfbfb;
        margin-top: 2%;
        width: 70%;
        margin-left: 18%;
        border-radius: 5px;
    }

    .textM {
        min-width: 98%;
        margin-top: 1%;
        margin-bottom: 1%;
        margin-left: 1%;
        margin-right: 1%;
    }

    .element {
        margin-top: 1%;
        margin-bottom: 1%;
        text-align: center;
    }

    .imageCenter {
        text-align: center;
    }

    .instruments {
        margin-bottom: 1%;
        margin-top: 1%;
        text-align: center
    }

    .instrument {
        padding: 20px;
        background-color: #007ced;
        border-radius: 30px;
    }

    .dragSteps {
       display:inline-block;
    }

    .cat {
        display:inline;
    }
  
    .index-content a:hover{
        color:black;
        text-decoration:none;
    }

.index-content .card{
    background-color: #FFFFFF;
    padding:0;
    -webkit-border-radius: 4px;
    -moz-border-radius: 4px;
    border-radius:4px;
    box-shadow: 0 4px 5px 0 rgba(0,0,0,0.14), 0 1px 10px 0 rgba(0,0,0,0.12), 0 2px 4px -1px rgba(0,0,0,0.3);

}
.index-content .card:hover{
    box-shadow: 0 16px 24px 2px rgba(0,0,0,0.14), 0 6px 30px 5px rgba(0,0,0,0.12), 0 8px 10px -5px rgba(0,0,0,0.3);
    color:black;
}
    .index-content .card .img {
        width: 100%;
        border-top-left-radius: 4px;
        border-top-right-radius: 4px;
    }
.index-content .card h4{
    margin:20px;
}

    .content {
       /*height:310px;*/
    }

</style>

<style>
    .header {
        background-color: #ffffff;
        word-wrap: break-word;
        border-radius: 5px;
        margin-top: 2%;
        width: 60%;
    }

    .info {
        width: 60%;
        border-radius: 5px;
        background-color: #ffffff;
        height: 40px;
    }

    .sp_method_toc {
        margin: 3px -15px;
        border: 0 27px;
        padding: 10px 27px 10px 27px;
        border: 0;
        color: #222;
        background-color: #f6f8f7;
        font-size: 12px;
        font-weight: bold;
        line-height: 1.65em;
    }

    #method_toc a {
        margin-right: 10px;
        background-repeat: no-repeat;
        background-position: 0px 4px;
        background-position-x: left;
        padding-left: 5px;
        display: inline-block;
    }

    .step {
        background-color: #ffffff;
        word-wrap: break-word;
        border-radius: 5px;
        margin-top: 2%;
        width: 60%;
        padding-left: 0;
        padding-right: 0;
        position: relative;
    }

    .headStep {
        display: inline-block;
    }


    .section .steps h3 {
        border-bottom: none;
        border-radius: 4px 4px 0 0;
        -moz-border-radius: 4px 4px 0 0;
        -webkit-border-radius: 4px 4px 0 0;
    }

    .section h3 {
        border-radius: 4px;
        -moz-border-radius: 4px;
        -webkit-border-radius: 4px;
        background: #f6f5f4;
    }

    h3 {
        margin-bottom: 0px;
        font-size: 20px;
        font-weight: bold;
        color: #222222;
        line-height: 18px;
        width: 100%;
        background-color: #1f7497;
        font-family: Helvetica,arial,sans-serif;
    }

    .section .steps .altblock {
        margin: 0 15px 0 0;
    }

    .steps .altblock {
        height: 49px;
        width: 60px;
        margin: 0 15px 0 0;
        font-size: 12px;
        line-height: 31px;
        text-align: center;
        padding-top: 10px;
        color: #fff;
        border-radius: 4px 0 0 0;
        -moz-border-radius: 4px 0 0 0;
        -webkit-border-radius: 4px 0 0 0;
    }

    .altblock {
        height: 18px;
        width: 18px;
        background-color: #1f7497;
        float: left;
        margin-right: 8px;
    }

    .section .altblock .method_label {
        margin-top: -1px;
        line-height: 12px;
        display: inline-block;
    }

    div.section .steps h3 .altblock span {
        font-size: 21px;
        padding: 0;
    }

    div.section h3 span {
        display: block;
        margin-left: 0px;
        padding: 16px 0px 15px 50px;
    }

    #createIns {
        text-align: center;
        color: #33618a;
        font-size: -webkit-xxx-large;
        margin-bottom: 4%;
        font-family: serif;
    }

    .ui-growl-item {
      z-index: 99999 !important;
      top:200px;
    }

    .ui-widget {
        z-index: 99999 !important;
    }

</style>

   <p-growl [(value)]="msgs"></p-growl>

<div class="col-md-8">
        <div [dragula]='"first-bag"' [dragulaModel]='instruction.steps'>
            <div *ngFor="let step of instruction.steps; let j = index">
                <p-panel [toggleable]="true" [style]="{'margin-top':'20px','width':'101%'}">
                    <p-header>
                        <label>Step {{j+1}}: </label>
                        <input [(ngModel)]="step.name" placeholder="Input step name" style="width: 100%; border: 0; background-color: #f1f2f5;" />
                        <a class="btn-xs pull-right ui-panel-titlebar-icon ui-panel-titlebar-toggler ui-corner-all ui-state-default" (click)="confirm2(j)">
                            <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                        </a>

                    </p-header>
                    <div [dragula]='"second-bag"' [dragulaModel]='step.blocks'>                      
                        <div *ngFor="let item of step.blocks; let i = index">
                            <div ngSwitch="{{item.type}}">
                                <div *ngSwitchCase="'text'">
                                    <div class="row textM">
                                        <div class="pull-left" style="margin-left:-2%">
                                            <span class="fa fa-hand-rock-o fa-lg"></span>
                                        </div>
                                        <div class="pull-right" style="margin-right:-2%">
                                            <span title="Delete" (click)="removeElement(j,i)" class="glyphicon glyphicon-trash "></span>
                                        </div>

                                        <div style="word-wrap:break-word;" [innerHTML]="item.field" *ngIf="!item.state" (click)="turn(j,i)">
                                        </div>

                                        <p-editor *ngIf="item.state" [(ngModel)]="item.field" [style]="{'height':'200px'}">
                                            <p-header>
                                                <span class="ql-formats">
                                                    <select class="ql-header">

                                                        <option value="2">Subheading</option>
                                                        <option selected="">Normal</option>
                                                    </select>
                                                    <button class="ql-bold" aria-label="Bold"></button>
                                                    <button class="ql-italic" aria-label="Italic"></button>
                                                    <button class="ql-underline" aria-label="Underline"></button>
                                                </span>
                                                <button class="pull-right" pButton type="button" icon="fa-close" (click)="turn(j,i)"></button>
                                            </p-header>
                                        </p-editor>

                                    </div>
                                </div>

                                <div *ngSwitchCase="'photo'">
                                    <div class="element">
                                        <div class="pull-left" style="margin-left:19%">
                                            <span class="fa fa-hand-rock-o fa-lg"></span>
                                        </div>
                                        <div class="pull-right" style="margin-right:19%">
                                            <span title="Delete" (click)="removeElement(j,i)" class="glyphicon glyphicon-trash "></span>
                                        </div>
                                        <img src={{item.field}} style="width:450px; height:250px;" />
                                    </div>
                                </div>

                                <div *ngSwitchCase="'video'">
                                    <div class="element" >
                                        <div class="pull-left" style="margin-left: 27%">
                                            <span class="fa fa-hand-rock-o fa-lg"></span>
                                        </div>
                                        <div class="pull-right" style="margin-right: 27%;">
                                            <span title="Delete" (click)="removeElement(j,i)" class="glyphicon glyphicon-trash "></span>
                                        </div>
                                        <div *ngIf="!item.state">

                                            <div class="form-horizontal">
                                                <input type="text" [(ngModel)]="item.field" class="form-control" placeholder="Youtube URL" style="width:280px;max-width:280px;display:inline-block" />
                                                <button (click)="addYoutubeUrl(j,i)" type="submit" class="btn btn-default" style="margin-left:-8px;margin-top:-2px; background-color:black;color:aliceblue">
                                                    Add
                                                </button>
                                            </div>

                                        </div>
                                        <iframe  *ngIf="item.state" [src]="item.field | safe" frameborder="0" allowfullscreen></iframe>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <p-footer>
                        <div class="instruments">
                            <label (click)="AddText(j)" style="font-size: initial;" title="Add text" class="btn instrument btn-default btn-1x"><span class="glyphicon glyphicon-pencil fa-lg" style="color:aliceblue"></span></label>
                            <label title="Add photo" class="btn instrument btn-default btn-lg" >
                                <span class="glyphicon glyphicon-camera " style="color:aliceblue"></span>
                                <input class="hidden" type="file" ng2FileSelect [uploader]="uploader" (change)="onChange($event,j)" />
                            </label>
                            <label (click)="AddVideo(j)" title="Add video" class="btn instrument btn-default btn-lg"><span class="glyphicon glyphicon-facetime-video" style="color:aliceblue"></span></label>
                        </div>
                    </p-footer>
                </p-panel>
            </div>
        </div>

   <button (click)="addStep()" class="btn btn-default" style="margin-top: 2%;margin-left: 46%;background-color: #1a89e9;color: white;">Add step</button>

</div>


<div class="col-md-3" style="background-color:white; margin-top:1.8%; margin-left: 3%; margin-bottom:3%">   
    
    <div class="row" style="border: 1px solid #d1d4d5;">

        <div class="form-group form-inline" style="padding-top: 12px; padding-left: 10px;">
            <label>Title</label>
            <input class="form-control" name="name" [(ngModel)]="instruction.name" required style="width: 80%; height: 27px;" />
        </div>

        <hr style="margin-top: 0px;margin-bottom: 5px;" />

        <div class="form-group form-inline" style="padding-left:10px; padding-top: 5px;">
            <label >Category</label>
            <p-dropdown [options]="cities" [(ngModel)]="selectedCity" placeholder="Select a City"></p-dropdown>
        </div>
        
        <hr style="margin-top: 0px;margin-bottom: 5px;" />

        <tag-input theme='bootstrap'
                   [(ngModel)]="tags"
                   [maxItems]='5'
                   [validators]="validators"
                   [errorMessages]="errorMessages">
        </tag-input>


    </div>

        <div class="row">
            <div class="btn-group btn-group-justified" role="group" aria-label="...">
                <div class="btn-group" role="group">
                    <button type="button" class="btn btn-default" style="background-color: #3897f0;border-radius: 0px;color: white;">Main image</button>
                </div>
                <div class="btn-group" role="group">
                    <button data-toggle="modal" data-target=".bd-example-modal-lg" type="button" class="btn btn-default" style="background-color: #3897f0;border-radius: 0px;color: white;">Preview</button>
                    
                </div>
                <div class="btn-group" role="group">
                    <button (click)="publish()" type="button" class="btn btn-default" style="background-color: #3897f0;border-radius: 0px;color: white;">Publish</button>
                </div>
            </div>
        </div>

         <div class="row" style="background-color:#ecebe8">
             <br />
         </div>

         <div class="row">
             <div class="index-content">
                 <div class="card">
                     <img src={{instruction.previewImageUrl}} style="width: 100%; height: 200px;" />
                     <h4>{{instruction.name}}</h4>
                     <div class="row">
                         <div class="pull-left" style="margin-left:7%">
                             <p>by Anton in Sport</p>
                         </div>
                         <div class="pull-right" style="margin-right:7%">
                             <p>0</p>
                         </div>
                     </div>
                 </div>
             </div>
         </div>
             
</div>

  <p-confirmDialog></p-confirmDialog>

<div class="modal fade bd-example-modal-lg" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">            
            <div class="modal-body" style="background-color:#ecebe8">

                <div class="header container" style="width:80%">
                    <h2>{{instruction.name}}</h2>
                    <p id="method_toc" class="sp_method_toc">
                        <span class="glyphicon glyphicon-cloud"></span>
                        <span>Tags: </span>
                        <a *ngFor="let stepName of instruction.steps; let i = index">#{{stepName.name}}</a>
                    </p>
                    <p id="method_toc" class="sp_method_toc">
                        <span>{{instruction.steps.length}} Steps :</span>
                        <a *ngFor="let stepName of instruction.steps; let i = index">{{i+1}}) {{stepName.name}}</a>
                    </p>
                    <img src={{instruction.previewImageUrl}} style="width: calc(100% + 30px);margin-left: -15px;" />
                    <div class="pull-left" style="line-height:40px">
                        Created by <a href="#">Sergey</a> in <a href="#">Sports</a>
                    </div>
                    <div class="pull-right" style="cursor:pointer;line-height:40px">
                        <span *ngIf="!like" (click)="putLike()">{{instruction.rating}} <span style="font-size: large ;margin-top: 12%; padding-left: 5px;" class="glyphicon glyphicon glyphicon-thumbs-up"></span></span>
                        <span *ngIf="like" (click)="putLike()">{{instruction.rating}} <span style="font-size: large ;margin-top: 12%; padding-left: 5px; color:#187bd5" class="glyphicon glyphicon glyphicon-thumbs-up"></span></span>
                    </div>
                </div>

                <div class="step container " *ngFor="let step of instruction.steps; let j = index" style="width:80%">
                    <div id="s{{j}}" class="section steps">
                        <h3 class="" style="padding: 0;margin-top: 0;">
                            <div class="altblock">
                                <label class="method_label">Step {{j+1}}</label>
                            </div>
                            <span class="mw-headline">{{step.name}}</span>
                        </h3>
                    </div>

                    <div *ngFor="let item of step.blocks; let i = index">
                        <div ngSwitch="{{item.type}}">
                            <div *ngSwitchCase="'text'">
                                <div style="word-wrap:break-word; padding:10px" [innerHTML]="item.field">
                                </div>
                            </div>

                            <div *ngSwitchCase="'photo'">
                                <img src={{item.field}} style="width:100%;" />
                            </div>

                            <div *ngSwitchCase="'video'">
                                <iframe style="width:100%; height:350px" [src]="item.field | safe" frameborder="0" allowfullscreen></iframe>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>


